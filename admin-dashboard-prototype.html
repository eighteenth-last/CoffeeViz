<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CoffeeViz Admin Dashboard Prototype</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background-color: #101014;
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #101014; 
        }
        ::-webkit-scrollbar-thumb {
            background: #27272a; 
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #3f3f46; 
        }
    </style>
</head>
<body class="text-white selection:bg-blue-500/30">

    <!-- Header -->
    <header class="h-16 bg-[#27272a] border-b border-white/5 px-6 flex items-center justify-between sticky top-0 z-50 backdrop-blur-md bg-opacity-90">
        <div class="flex items-center gap-4">
            <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-blue-500 to-cyan-400 flex items-center justify-center shadow-lg shadow-blue-500/20">
                <i class="fas fa-shield-alt text-white text-sm"></i>
            </div>
            <h1 class="text-lg font-bold tracking-wide text-white">
                CoffeeViz <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-300">Admin</span>
            </h1>
        </div>
        
        <div class="flex items-center gap-6">
            <!-- Search -->
            <div class="relative hidden md:block group">
                <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-neutral-500 group-focus-within:text-blue-400 transition-colors"></i>
                <input 
                    type="text" 
                    placeholder="搜索设置..." 
                    class="h-9 w-64 bg-[#18181c] border border-white/10 rounded-full pl-10 pr-4 text-xs focus:outline-none focus:border-blue-500/50 focus:ring-1 focus:ring-blue-500/50 transition-all placeholder-neutral-600 text-neutral-300"
                >
            </div>
            
            <!-- Actions -->
            <div class="flex items-center gap-3">
                <button class="w-8 h-8 rounded-full bg-[#18181c] hover:bg-blue-500/20 text-neutral-400 hover:text-blue-400 flex items-center justify-center transition-all cursor-pointer">
                    <i class="fas fa-bell text-xs"></i>
                </button>
                <button class="w-8 h-8 rounded-full bg-[#18181c] hover:bg-blue-500/20 text-neutral-400 hover:text-blue-400 flex items-center justify-center transition-all cursor-pointer">
                    <i class="fas fa-cog text-xs"></i>
                </button>
                <div class="w-8 h-8 rounded-full bg-gradient-to-br from-neutral-700 to-neutral-800 border border-white/10 flex items-center justify-center cursor-pointer">
                    <span class="text-xs font-bold text-neutral-300">A</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="p-6">
        
        <!-- Stats Overview -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8" id="stats-container">
            <!-- Stats will be injected here by JS -->
        </div>

        <!-- Quick Actions Grid -->
        <div class="mb-4 flex items-center justify-between">
            <h2 class="text-lg font-bold text-white flex items-center">
                <i class="fas fa-th-large mr-2 text-blue-500"></i> 业务管理模块
            </h2>
            <div class="flex gap-2">
                <button class="p-1.5 rounded bg-[#18181c] text-neutral-400 hover:text-white hover:bg-blue-600 transition-colors cursor-pointer"><i class="fas fa-filter text-xs"></i></button>
                <button class="p-1.5 rounded bg-[#18181c] text-neutral-400 hover:text-white hover:bg-blue-600 transition-colors cursor-pointer"><i class="fas fa-sort text-xs"></i></button>
            </div>
        </div>

        <div class="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-4 mb-8" id="modules-container">
            <!-- Modules will be injected here by JS -->
        </div>

        <!-- Recent Activity / Tables -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Main Table -->
            <div class="lg:col-span-2 bg-[#18181c] rounded-2xl border border-white/5 overflow-hidden flex flex-col">
                <div class="p-4 border-b border-white/5 flex justify-between items-center bg-[#27272a]/50">
                    <h3 class="font-bold text-sm text-white">最近用户订阅</h3>
                    <button class="text-xs text-blue-400 hover:text-blue-300 transition-colors cursor-pointer">查看全部</button>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-left border-collapse">
                        <thead>
                            <tr class="bg-[#27272a] text-xs uppercase text-neutral-400 tracking-wider">
                                <th class="p-4 font-medium">用户</th>
                                <th class="p-4 font-medium">计划</th>
                                <th class="p-4 font-medium">状态</th>
                                <th class="p-4 font-medium">金额</th>
                                <th class="p-4 font-medium">日期</th>
                            </tr>
                        </thead>
                        <tbody class="text-sm" id="table-body">
                            <!-- Table rows will be injected here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Side Panel -->
            <div class="bg-[#18181c] rounded-2xl border border-white/5 p-5 flex flex-col h-full">
                <h3 class="font-bold text-sm text-white mb-4">系统健康度</h3>
                
                <div class="space-y-6 flex-1" id="health-stats">
                    <!-- Health stats will be injected here -->
                </div>

                <div class="mt-8 p-4 rounded-xl bg-gradient-to-br from-blue-600/10 to-purple-600/10 border border-blue-500/20 relative overflow-hidden">
                    <div class="relative z-10">
                        <div class="text-blue-400 text-xs font-bold mb-1">AI 服务状态</div>
                        <div class="text-white font-bold text-lg mb-2">运行正常</div>
                        <p class="text-neutral-400 text-xs leading-relaxed">所有 AI 模型节点响应时间在预期范围内。</p>
                    </div>
                    <i class="fas fa-robot absolute -bottom-2 -right-2 text-6xl text-blue-500/10 transform rotate-12"></i>
                </div>
            </div>
        </div>

    </main>

    <!-- Module Detail Modal -->
    <div id="module-modal" class="fixed inset-0 z-[100] hidden">
        <!-- Backdrop -->
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm transition-opacity opacity-0" id="modal-backdrop"></div>
        
        <!-- Modal Content -->
        <div class="absolute inset-0 flex items-center justify-center p-4 sm:p-6">
            <div class="bg-[#18181c] border border-white/10 w-full max-w-5xl h-[85vh] rounded-2xl shadow-2xl transform scale-95 opacity-0 transition-all duration-300 flex flex-col overflow-hidden" id="modal-content">
                
                <!-- Modal Header -->
                <div class="h-16 border-b border-white/5 flex items-center justify-between px-6 bg-[#202025]">
                    <div class="flex items-center gap-3">
                        <div id="modal-icon-container" class="w-8 h-8 rounded-lg flex items-center justify-center text-lg">
                            <i id="modal-icon" class="fas fa-cube"></i>
                        </div>
                        <h2 id="modal-title" class="text-lg font-bold text-white">模块详情</h2>
                    </div>
                    <div class="flex items-center gap-3">
                        <button class="w-8 h-8 rounded-full bg-[#27272a] hover:bg-white/10 flex items-center justify-center text-neutral-400 hover:text-white transition-colors">
                            <i class="fas fa-expand text-xs"></i>
                        </button>
                        <button onclick="closeModal()" class="w-8 h-8 rounded-full bg-[#27272a] hover:bg-red-500/20 flex items-center justify-center text-neutral-400 hover:text-red-500 transition-colors">
                            <i class="fas fa-times text-sm"></i>
                        </button>
                    </div>
                </div>

                <!-- Modal Body -->
                <div id="modal-body" class="flex-1 overflow-y-auto p-6 bg-[#101014]">
                    <!-- Dynamic Content Injected Here -->
                </div>

                <!-- Modal Footer -->
                <div class="h-14 border-t border-white/5 flex items-center justify-between px-6 bg-[#202025]">
                    <div class="text-xs text-neutral-500">
                        <i class="fas fa-info-circle mr-1"></i> Press ESC to close
                    </div>
                    <div class="flex gap-3">
                        <button onclick="closeModal()" class="px-4 py-1.5 rounded-lg border border-white/10 text-xs font-medium text-neutral-400 hover:text-white hover:border-white/20 transition-all">取消</button>
                        <button class="px-4 py-1.5 rounded-lg bg-blue-600 hover:bg-blue-500 text-xs font-bold text-white shadow-lg shadow-blue-600/20 transition-all">保存更改</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data
        const stats = [
            { label: '总用户数', value: '12,543', trend: '12%', icon: 'fa-users', color: '#3b82f6', gradientClass: 'from-blue-600 to-blue-400' },
            { label: '本月收入', value: '¥45,230', trend: '8.5%', icon: 'fa-yen-sign', color: '#10b981', gradientClass: 'from-green-600 to-green-400' },
            { label: '活跃项目', value: '3,892', trend: '5.2%', icon: 'fa-project-diagram', color: '#f59e0b', gradientClass: 'from-amber-600 to-amber-400' },
            { label: 'API 调用', value: '1.2M', trend: '24%', icon: 'fa-server', color: '#8b5cf6', gradientClass: 'from-purple-600 to-purple-400' },
        ];

        const modules = [
            { name: '用户管理', icon: 'fa-user-cog', bgClass: 'bg-blue-500/10', textClass: 'text-blue-500' },
            { name: '订阅订单', icon: 'fa-file-invoice-dollar', bgClass: 'bg-green-500/10', textClass: 'text-green-500' },
            { name: '项目概览', icon: 'fa-layer-group', bgClass: 'bg-amber-500/10', textClass: 'text-amber-500' },
            { name: 'AI 模型', icon: 'fa-brain', bgClass: 'bg-cyan-500/10', textClass: 'text-cyan-500' },
            { name: '系统设置', icon: 'fa-cogs', bgClass: 'bg-neutral-500/10', textClass: 'text-neutral-400' },
        ];

        const healthStats = [
            { label: 'CPU 使用率', value: 42, color: 'bg-blue-500' },
            { label: '内存占用', value: 68, color: 'bg-purple-500' },
            { label: '存储空间', value: 24, color: 'bg-green-500' },
            { label: '网络流量', value: 55, color: 'bg-amber-500' },
        ];

        // Render Stats
        const statsContainer = document.getElementById('stats-container');
        stats.forEach(stat => {
            const el = document.createElement('div');
            el.className = 'bg-[#18181c] p-5 rounded-2xl border border-white/5 hover:border-blue-500/30 transition-all duration-300 group relative overflow-hidden';
            el.innerHTML = `
                <div class="absolute top-0 right-0 p-3 opacity-10 group-hover:opacity-20 transition-opacity transform group-hover:scale-110 duration-500">
                    <i class="fas ${stat.icon} text-6xl" style="color: ${stat.color}"></i>
                </div>
                <div class="relative z-10">
                    <div class="text-neutral-400 text-xs font-medium uppercase tracking-wider mb-2">${stat.label}</div>
                    <div class="text-2xl font-black text-white flex items-end gap-2">
                        ${stat.value}
                        <span class="text-xs font-medium text-green-500 mb-1 flex items-center">
                            <i class="fas fa-arrow-up mr-1 text-[10px]"></i> ${stat.trend}
                        </span>
                    </div>
                </div>
                <div class="absolute bottom-0 left-0 h-1 bg-gradient-to-r ${stat.gradientClass} transition-all duration-500 w-0 group-hover:w-full"></div>
            `;
            statsContainer.appendChild(el);
        });

        // Render Modules
        const modulesContainer = document.getElementById('modules-container');
        modules.forEach(module => {
            const el = document.createElement('div');
            el.className = 'bg-[#18181c] aspect-square rounded-2xl border border-white/5 flex flex-col items-center justify-center gap-3 cursor-pointer group hover:bg-[#202025] hover:border-blue-500/50 hover:shadow-lg hover:shadow-blue-900/20 transition-all duration-300 relative overflow-hidden';
            el.onclick = () => openModal(module);
            el.innerHTML = `
                <div class="absolute inset-0 bg-gradient-to-br from-blue-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                <div class="w-12 h-12 rounded-xl flex items-center justify-center text-2xl mb-1 transition-all duration-300 transform group-hover:scale-110 group-hover:-translate-y-1 shadow-inner ${module.bgClass} ${module.textClass}">
                    <i class="fas ${module.icon}"></i>
                </div>
                <div class="text-xs font-medium text-neutral-400 group-hover:text-white transition-colors text-center px-2 z-10">
                    ${module.name}
                </div>
                <div class="absolute bottom-2 opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-2 group-hover:translate-y-0">
                    <i class="fas fa-chevron-right text-[10px] text-blue-500"></i>
                </div>
            `;
            modulesContainer.appendChild(el);
        });

        // Modal Logic
        const modal = document.getElementById('module-modal');
        const modalBackdrop = document.getElementById('modal-backdrop');
        const modalContent = document.getElementById('modal-content');
        const modalBody = document.getElementById('modal-body');
        const modalTitle = document.getElementById('modal-title');
        const modalIcon = document.getElementById('modal-icon');
        const modalIconContainer = document.getElementById('modal-icon-container');

        function openModal(module) {
            modal.classList.remove('hidden');
            // Trigger reflow
            void modal.offsetWidth;
            
            // Animation
            modalBackdrop.classList.remove('opacity-0');
            modalContent.classList.remove('opacity-0', 'scale-95');
            modalContent.classList.add('scale-100');

            // Set Content
            modalTitle.textContent = module.name;
            modalIcon.className = `fas ${module.icon}`;
            modalIconContainer.className = `w-8 h-8 rounded-lg flex items-center justify-center text-lg ${module.bgClass} ${module.textClass}`;
            
            // Render specific template
            renderModuleTemplate(module);
        }

        function closeModal() {
            modalBackdrop.classList.add('opacity-0');
            modalContent.classList.remove('scale-100');
            modalContent.classList.add('opacity-0', 'scale-95');
            
            setTimeout(() => {
                modal.classList.add('hidden');
                modalBody.innerHTML = ''; // Clear content
            }, 300);
        }

        // Close on backdrop click
        modalBackdrop.onclick = closeModal;
        
        // Close on ESC
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && !modal.classList.contains('hidden')) {
                closeModal();
            }
        });

        // Template Renderer
        function renderModuleTemplate(module) {
            let html = '';
            let shouldInitCharts = false;
            
            // Clear any existing chart instances to prevent memory leaks or rendering issues
            if (window.activeCharts) {
                window.activeCharts.forEach(chart => chart.destroy());
                window.activeCharts = [];
            }
            
            switch (module.name) {
                case '用户管理':
                    html = generateUserManagementTemplate();
                    break;
                case '订阅订单':
                    html = generateOrdersTemplate();
                    break;
                case '项目概览':
                    html = generateProjectsTemplate();
                    break;
                case '系统设置':
                    html = generateSettingsTemplate();
                    break;
                case 'AI 模型':
                    html = generateAnalyticsTemplate(module); // Reusing analytics template for AI stats for now, or check if specific AI template exists.
                    // Wait, original code used generateAnalyticsTemplate for 'AI 模型' too.
                    shouldInitCharts = true;
                    break;
                default:
                    html = generateDefaultTemplate(module);
            }
            
            modalBody.innerHTML = html;

            if (shouldInitCharts) {
                initCharts();
            }
        }

        // --- Specific Templates ---

        function generateUserManagementTemplate() {
            return `
                <div class="flex flex-col h-full">
                    <div class="flex justify-between items-center mb-6">
                        <div class="flex gap-3">
                            <div class="relative">
                                <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-neutral-500"></i>
                                <input type="text" placeholder="搜索用户..." class="bg-[#18181c] border border-white/10 rounded-lg pl-10 pr-4 py-2 text-sm text-white focus:border-blue-500/50 focus:outline-none w-64">
                            </div>
                            <select class="bg-[#18181c] border border-white/10 rounded-lg px-3 py-2 text-sm text-neutral-400 focus:outline-none">
                                <option>所有角色</option>
                                <option>管理员</option>
                                <option>普通用户</option>
                                <option>VIP用户</option>
                            </select>
                            <select class="bg-[#18181c] border border-white/10 rounded-lg px-3 py-2 text-sm text-neutral-400 focus:outline-none">
                                <option>所有状态</option>
                                <option>正常</option>
                                <option>禁用</option>
                            </select>
                        </div>
                        <button class="px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white text-sm font-bold rounded-lg transition-colors flex items-center gap-2 shadow-lg shadow-blue-600/20">
                            <i class="fas fa-user-plus"></i> 新增用户
                        </button>
                    </div>
                    
                    <div class="flex-1 overflow-auto bg-[#18181c] rounded-xl border border-white/5">
                        <table class="w-full text-left border-collapse">
                            <thead class="sticky top-0 bg-[#202025] z-10">
                                <tr class="text-xs uppercase text-neutral-400 tracking-wider">
                                    <th class="p-4 font-medium border-b border-white/5 w-12"><input type="checkbox" class="rounded border-white/20 bg-transparent"></th>
                                    <th class="p-4 font-medium border-b border-white/5">用户</th>
                                    <th class="p-4 font-medium border-b border-white/5">角色</th>
                                    <th class="p-4 font-medium border-b border-white/5">状态</th>
                                    <th class="p-4 font-medium border-b border-white/5">最后登录</th>
                                    <th class="p-4 font-medium border-b border-white/5 text-right">操作</th>
                                </tr>
                            </thead>
                            <tbody class="text-sm divide-y divide-white/5">
                                ${Array(8).fill(0).map((_, i) => `
                                <tr class="hover:bg-white/[0.02] transition-colors group">
                                    <td class="p-4"><input type="checkbox" class="rounded border-white/20 bg-transparent"></td>
                                    <td class="p-4">
                                        <div class="flex items-center gap-3">
                                            <div class="w-9 h-9 rounded-full bg-gradient-to-br from-neutral-700 to-neutral-800 border border-white/5 flex items-center justify-center text-xs text-white overflow-hidden">
                                                <i class="fas fa-user text-neutral-400"></i>
                                            </div>
                                            <div>
                                                <div class="text-white font-medium">User_${100+i}</div>
                                                <div class="text-xs text-neutral-500">user${100+i}@example.com</div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="p-4">
                                        <span class="flex items-center gap-1.5">
                                            <i class="fas ${i % 3 === 0 ? 'fa-shield-alt text-blue-500' : 'fa-user text-neutral-500'} text-xs"></i>
                                            <span class="text-neutral-300">${i % 3 === 0 ? '管理员' : '普通用户'}</span>
                                        </span>
                                    </td>
                                    <td class="p-4">
                                        <span class="px-2 py-0.5 rounded text-[10px] font-bold ${i === 2 ? 'bg-red-500/10 text-red-500 border border-red-500/20' : 'bg-green-500/10 text-green-500 border border-green-500/20'}">
                                            ${i === 2 ? '已禁用' : '正常'}
                                        </span>
                                    </td>
                                    <td class="p-4 text-neutral-500 text-xs">
                                        <div>2023-10-${10 + i}</div>
                                        <div class="text-[10px] opacity-60">14:2${i}:00</div>
                                    </td>
                                    <td class="p-4 text-right">
                                        <button class="w-8 h-8 rounded hover:bg-white/5 text-neutral-500 hover:text-blue-400 transition-colors"><i class="fas fa-edit"></i></button>
                                        <button class="w-8 h-8 rounded hover:bg-white/5 text-neutral-500 hover:text-red-400 transition-colors"><i class="fas fa-trash-alt"></i></button>
                                    </td>
                                </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function generateOrdersTemplate() {
             return `
                <div class="flex flex-col h-full">
                    <div class="grid grid-cols-4 gap-4 mb-6">
                         <div class="bg-[#18181c] p-4 rounded-xl border border-white/5 flex items-center justify-between">
                            <div>
                                <div class="text-xs text-neutral-500 mb-1">今日收入</div>
                                <div class="text-lg font-bold text-white">¥2,340.00</div>
                            </div>
                            <div class="w-10 h-10 rounded-lg bg-green-500/10 flex items-center justify-center text-green-500"><i class="fas fa-yen-sign"></i></div>
                        </div>
                        <div class="bg-[#18181c] p-4 rounded-xl border border-white/5 flex items-center justify-between">
                            <div>
                                <div class="text-xs text-neutral-500 mb-1">待支付订单</div>
                                <div class="text-lg font-bold text-white">12</div>
                            </div>
                            <div class="w-10 h-10 rounded-lg bg-amber-500/10 flex items-center justify-center text-amber-500"><i class="fas fa-clock"></i></div>
                        </div>
                        <div class="bg-[#18181c] p-4 rounded-xl border border-white/5 flex items-center justify-between">
                            <div>
                                <div class="text-xs text-neutral-500 mb-1">总订单数</div>
                                <div class="text-lg font-bold text-white">8,932</div>
                            </div>
                            <div class="w-10 h-10 rounded-lg bg-blue-500/10 flex items-center justify-center text-blue-500"><i class="fas fa-shopping-bag"></i></div>
                        </div>
                         <div class="bg-[#18181c] p-4 rounded-xl border border-white/5 flex items-center justify-between">
                            <div>
                                <div class="text-xs text-neutral-500 mb-1">退款率</div>
                                <div class="text-lg font-bold text-white">0.5%</div>
                            </div>
                            <div class="w-10 h-10 rounded-lg bg-red-500/10 flex items-center justify-center text-red-500"><i class="fas fa-undo"></i></div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between items-center mb-4">
                        <div class="flex gap-3">
                             <input type="text" placeholder="搜索订单号/用户..." class="bg-[#18181c] border border-white/10 rounded-lg pl-4 pr-4 py-2 text-sm text-white focus:border-blue-500/50 focus:outline-none w-64">
                             <button class="px-3 py-2 bg-[#18181c] border border-white/10 rounded-lg text-neutral-400 hover:text-white transition-colors"><i class="fas fa-download"></i> 导出报表</button>
                        </div>
                    </div>

                    <div class="flex-1 overflow-auto bg-[#18181c] rounded-xl border border-white/5">
                        <table class="w-full text-left border-collapse">
                            <thead class="sticky top-0 bg-[#202025] z-10">
                                <tr class="text-xs uppercase text-neutral-400 tracking-wider">
                                    <th class="p-4 font-medium border-b border-white/5">订单号</th>
                                    <th class="p-4 font-medium border-b border-white/5">用户</th>
                                    <th class="p-4 font-medium border-b border-white/5">订阅计划</th>
                                    <th class="p-4 font-medium border-b border-white/5">金额</th>
                                    <th class="p-4 font-medium border-b border-white/5">支付方式</th>
                                    <th class="p-4 font-medium border-b border-white/5">状态</th>
                                    <th class="p-4 font-medium border-b border-white/5 text-right">操作</th>
                                </tr>
                            </thead>
                            <tbody class="text-sm divide-y divide-white/5">
                                ${Array(8).fill(0).map((_, i) => `
                                <tr class="hover:bg-white/[0.02] transition-colors">
                                    <td class="p-4 font-mono text-neutral-400 text-xs">#ORD-2023-${1000+i}</td>
                                    <td class="p-4">
                                        <div class="flex items-center gap-2">
                                            <div class="w-6 h-6 rounded-full bg-neutral-700 flex items-center justify-center text-[10px]">U</div>
                                            <span class="text-white text-sm">User_${i+1}</span>
                                        </div>
                                    </td>
                                    <td class="p-4">
                                        <span class="px-2 py-0.5 rounded text-[10px] font-bold border ${i%2===0 ? 'border-amber-500/20 text-amber-500 bg-amber-500/5' : 'border-purple-500/20 text-purple-500 bg-purple-500/5'}">
                                            ${i%2===0 ? '专业版' : '团队版'}
                                        </span>
                                    </td>
                                    <td class="p-4 font-medium text-white">¥${i%2===0 ? '99.00' : '299.00'}</td>
                                    <td class="p-4 text-neutral-400 text-xs"><i class="fab fa-alipay text-blue-400 mr-1"></i> 支付宝</td>
                                    <td class="p-4">
                                        <span class="flex items-center gap-1.5 text-xs text-green-400">
                                            <i class="fas fa-check-circle"></i> 已支付
                                        </span>
                                    </td>
                                    <td class="p-4 text-right">
                                        <button class="text-neutral-500 hover:text-white transition-colors text-xs border border-white/10 px-2 py-1 rounded">详情</button>
                                    </td>
                                </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function generateProjectsTemplate() {
            return `
                <div class="flex flex-col h-full">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-white font-bold text-lg">项目列表</h3>
                        <div class="flex gap-2">
                             <button class="w-9 h-9 rounded-lg bg-[#18181c] border border-white/10 flex items-center justify-center text-white"><i class="fas fa-list"></i></button>
                             <button class="w-9 h-9 rounded-lg bg-[#18181c] border border-white/10 flex items-center justify-center text-neutral-500 hover:text-white"><i class="fas fa-th-large"></i></button>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 overflow-y-auto pb-4">
                        ${Array(9).fill(0).map((_, i) => `
                        <div class="bg-[#18181c] rounded-xl border border-white/5 overflow-hidden group hover:border-blue-500/30 transition-all">
                            <div class="h-32 bg-neutral-800 relative">
                                <div class="absolute inset-0 flex items-center justify-center text-neutral-700">
                                    <i class="fas fa-project-diagram text-4xl opacity-20 group-hover:opacity-30 transition-opacity"></i>
                                </div>
                                <div class="absolute top-3 right-3 px-2 py-1 bg-black/50 backdrop-blur-md rounded text-[10px] text-white border border-white/10">
                                    ${Math.floor(Math.random() * 20 + 5)} 个图表
                                </div>
                            </div>
                            <div class="p-4">
                                <div class="flex justify-between items-start mb-2">
                                    <h4 class="text-white font-bold group-hover:text-blue-400 transition-colors">电商系统 v${i+1}.0</h4>
                                    <button class="text-neutral-500 hover:text-white"><i class="fas fa-ellipsis-v"></i></button>
                                </div>
                                <p class="text-xs text-neutral-500 mb-4 line-clamp-2">包含订单处理和库存管理的新电商平台核心架构。</p>
                                
                                <div class="flex items-center justify-between pt-3 border-t border-white/5">
                                    <div class="flex items-center gap-2">
                                        <div class="w-6 h-6 rounded-full bg-blue-500 flex items-center justify-center text-[10px] text-white">PM</div>
                                        <span class="text-xs text-neutral-400">项目经理</span>
                                    </div>
                                    <div class="text-[10px] text-neutral-600">2小时前更新</div>
                                </div>
                            </div>
                        </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function generateSettingsTemplate() {
            return `
                <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-full">
                    <!-- Sidebar Navigation -->
                    <div class="bg-[#18181c] rounded-xl border border-white/5 p-2 h-full">
                        <div class="space-y-1">
                            <button class="w-full text-left px-4 py-2.5 rounded-lg bg-blue-600/10 text-blue-500 text-sm font-medium flex items-center gap-3">
                                <i class="fas fa-sliders-h w-4"></i> 通用设置
                            </button>
                            <button class="w-full text-left px-4 py-2.5 rounded-lg hover:bg-white/5 text-neutral-400 hover:text-white text-sm font-medium flex items-center gap-3 transition-colors">
                                <i class="fas fa-shield-alt w-4"></i> 安全策略
                            </button>
                            <button class="w-full text-left px-4 py-2.5 rounded-lg hover:bg-white/5 text-neutral-400 hover:text-white text-sm font-medium flex items-center gap-3 transition-colors">
                                <i class="fas fa-envelope w-4"></i> 邮件服务
                            </button>
                            <button class="w-full text-left px-4 py-2.5 rounded-lg hover:bg-white/5 text-neutral-400 hover:text-white text-sm font-medium flex items-center gap-3 transition-colors">
                                <i class="fas fa-hdd w-4"></i> 存储配置
                            </button>
                             <button class="w-full text-left px-4 py-2.5 rounded-lg hover:bg-white/5 text-neutral-400 hover:text-white text-sm font-medium flex items-center gap-3 transition-colors">
                                <i class="fas fa-code-branch w-4"></i> 版本控制
                            </button>
                        </div>
                    </div>

                    <!-- Main Form Area -->
                    <div class="lg:col-span-3 bg-[#18181c] rounded-xl border border-white/5 p-8 overflow-y-auto">
                        <h3 class="text-xl font-bold text-white mb-6 pb-4 border-b border-white/5">通用设置</h3>
                        
                        <div class="space-y-6 max-w-2xl">
                            <div>
                                <label class="block text-sm font-medium text-neutral-300 mb-2">站点名称</label>
                                <input type="text" value="CoffeeViz Admin" class="w-full bg-[#101014] border border-white/10 rounded-lg px-4 py-2.5 text-white focus:border-blue-500/50 outline-none transition-all">
                                <p class="text-xs text-neutral-600 mt-1">显示在浏览器标题栏和登录页面的名称。</p>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-neutral-300 mb-2">站点 Logo</label>
                                <div class="flex items-center gap-4">
                                    <div class="w-16 h-16 rounded-lg bg-[#101014] border border-white/10 flex items-center justify-center">
                                        <img src="https://via.placeholder.com/40" alt="Logo" class="opacity-50">
                                    </div>
                                    <button class="px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-sm text-white hover:bg-white/10 transition-colors">上传新图片</button>
                                </div>
                            </div>

                            <div class="grid grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-neutral-300 mb-2">默认语言</label>
                                    <select class="w-full bg-[#101014] border border-white/10 rounded-lg px-4 py-2.5 text-white focus:border-blue-500/50 outline-none">
                                        <option>简体中文</option>
                                        <option>English</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-neutral-300 mb-2">时区</label>
                                    <select class="w-full bg-[#101014] border border-white/10 rounded-lg px-4 py-2.5 text-white focus:border-blue-500/50 outline-none">
                                        <option>(GMT+08:00) Beijing, Chongqing, Hong Kong</option>
                                        <option>(GMT+00:00) UTC</option>
                                    </select>
                                </div>
                            </div>

                            <div class="pt-4 border-t border-white/5">
                                <label class="block text-sm font-medium text-neutral-300 mb-4">功能开关</label>
                                <div class="space-y-3">
                                    <div class="flex items-center justify-between p-3 rounded-lg bg-[#101014] border border-white/5">
                                        <div>
                                            <div class="text-sm text-white">允许新用户注册</div>
                                            <div class="text-xs text-neutral-500">关闭后仅管理员可创建用户</div>
                                        </div>
                                        <div class="w-10 h-5 bg-green-600 rounded-full relative cursor-pointer">
                                            <div class="absolute right-0.5 top-0.5 w-4 h-4 bg-white rounded-full"></div>
                                        </div>
                                    </div>
                                    <div class="flex items-center justify-between p-3 rounded-lg bg-[#101014] border border-white/5">
                                        <div>
                                            <div class="text-sm text-white">强制两步验证 (2FA)</div>
                                            <div class="text-xs text-neutral-500">所有管理员必须开启 2FA</div>
                                        </div>
                                        <div class="w-10 h-5 bg-neutral-700 rounded-full relative cursor-pointer">
                                            <div class="absolute left-0.5 top-0.5 w-4 h-4 bg-white rounded-full"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateDefaultTemplate(module) {
            return `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-[#18181c] p-6 rounded-xl border border-white/5">
                        <h3 class="text-white font-bold mb-4 flex items-center gap-2">
                            <i class="fas fa-info-circle text-blue-500"></i> 基本信息
                        </h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-xs text-neutral-500 mb-1">模块名称</label>
                                <input type="text" value="\${module.name}" class="w-full bg-[#101014] border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-blue-500/50 outline-none">
                            </div>
                            <div>
                                <label class="block text-xs text-neutral-500 mb-1">描述</label>
                                <textarea class="w-full bg-[#101014] border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-blue-500/50 outline-none h-24">这是 \${module.name} 的配置面板，您可以在此处管理相关设置。</textarea>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-[#101014] rounded-lg border border-white/5">
                                <span class="text-sm text-neutral-300">启用该模块</span>
                                <div class="w-10 h-5 bg-green-600 rounded-full relative cursor-pointer">
                                    <div class="absolute right-0.5 top-0.5 w-4 h-4 bg-white rounded-full"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-[#18181c] p-6 rounded-xl border border-white/5">
                        <h3 class="text-white font-bold mb-4 flex items-center gap-2">
                            <i class="fas fa-history text-purple-500"></i> 最近操作
                        </h3>
                        <div class="space-y-4">
                            \${Array(5).fill(0).map((_, i) => \`
                            <div class="flex items-start gap-3 pb-3 border-b border-white/5 last:border-0">
                                <div class="w-8 h-8 rounded bg-neutral-800 flex items-center justify-center text-xs text-neutral-400 mt-0.5">
                                    <i class="fas fa-terminal"></i>
                                </div>
                                <div>
                                    <div class="text-sm text-white font-medium">系统更新 v2.\${i}</div>
                                    <div class="text-xs text-neutral-500 mt-1">更新了 \${module.name} 模块的配置文件。</div>
                                    <div class="text-[10px] text-neutral-600 mt-2">2小时前</div>
                                </div>
                            </div>
                            \`).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function generateAnalyticsTemplate(module) {
            const resourceRows = Array(5).fill(0).map((_, i) => `
                <div class="flex justify-between items-center text-sm">
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 rounded-full bg-blue-500"></div>
                        <span class="text-neutral-300">资源 ${String.fromCharCode(65+i)}</span>
                    </div>
                    <span class="text-white font-mono">${Math.floor(Math.random() * 100)}%</span>
                </div>
            `).join('');

            return `
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 h-full">
                    <div class="lg:col-span-2 flex flex-col gap-6">
                        <!-- Main Chart -->
                        <div class="bg-[#18181c] p-6 rounded-xl border border-white/5 flex-1 min-h-[300px]">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-white font-bold">趋势分析</h3>
                                <select class="bg-[#101014] border border-white/10 rounded px-2 py-1 text-xs text-neutral-300 outline-none">
                                    <option>最近7天</option>
                                    <option>最近30天</option>
                                    <option>今年</option>
                                </select>
                            </div>
                            <div class="relative h-[300px] w-full">
                                <canvas id="mainChart"></canvas>
                            </div>
                        </div>
                        
                        <!-- Secondary Stats -->
                        <div class="grid grid-cols-3 gap-4">
                            <div class="bg-[#18181c] p-4 rounded-xl border border-white/5">
                                <div class="text-xs text-neutral-500 mb-1">总请求</div>
                                <div class="text-xl font-bold text-white">2.4M</div>
                                <div class="text-xs text-green-500 mt-1"><i class="fas fa-arrow-up"></i> 12%</div>
                            </div>
                            <div class="bg-[#18181c] p-4 rounded-xl border border-white/5">
                                <div class="text-xs text-neutral-500 mb-1">平均耗时</div>
                                <div class="text-xl font-bold text-white">45ms</div>
                                <div class="text-xs text-green-500 mt-1"><i class="fas fa-arrow-down"></i> 5%</div>
                            </div>
                            <div class="bg-[#18181c] p-4 rounded-xl border border-white/5">
                                <div class="text-xs text-neutral-500 mb-1">错误率</div>
                                <div class="text-xl font-bold text-white">0.02%</div>
                                <div class="text-xs text-red-500 mt-1"><i class="fas fa-arrow-up"></i> 0.01%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-[#18181c] p-6 rounded-xl border border-white/5 flex flex-col">
                        <h3 class="text-white font-bold mb-6">分布统计</h3>
                        <div class="relative h-[250px] w-full mb-6">
                            <canvas id="pieChart"></canvas>
                        </div>
                        
                        <div class="space-y-4 flex-1 overflow-auto">
                            <h4 class="text-xs font-bold text-neutral-500 uppercase">热门资源</h4>
                            ${resourceRows}
                        </div>
                    </div>
                </div>
            `;
        }

        function initCharts() {
            // Wait for DOM update
            setTimeout(() => {
                const mainCanvas = document.getElementById('mainChart');
                const pieCanvas = document.getElementById('pieChart');

                // Safety check: Ensure canvas elements exist before initializing charts
                if (!mainCanvas || !pieCanvas) return;

                const ctx1 = mainCanvas.getContext('2d');
                const chart1 = new Chart(ctx1, {
                    type: 'line',
                    data: {
                        labels: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
                        datasets: [{
                            label: '请求数',
                            data: [65, 59, 80, 81, 56, 55, 40],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            fill: true,
                            tension: 0.4
                        }, {
                            label: '错误数',
                            data: [5, 2, 8, 1, 6, 2, 4],
                            borderColor: '#ef4444',
                            backgroundColor: 'transparent',
                            borderDash: [5, 5],
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } },
                        scales: {
                            y: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#737373' } },
                            x: { grid: { display: false }, ticks: { color: '#737373' } }
                        }
                    }
                });

                const ctx2 = pieCanvas.getContext('2d');
                const chart2 = new Chart(ctx2, {
                    type: 'doughnut',
                    data: {
                        labels: ['类型 A', '类型 B', '类型 C', '类型 D'],
                        datasets: [{
                            data: [30, 20, 15, 35],
                            backgroundColor: ['#3b82f6', '#10b981', '#f59e0b', '#8b5cf6'],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { position: 'bottom', labels: { color: '#a3a3a3', usePointStyle: true } } },
                        cutout: '70%'
                    }
                });
                
                // Store chart instances globally to destroy them later
                window.activeCharts = [chart1, chart2];
            }, 50);
        }

        // Render Table Rows
        const tableBody = document.getElementById('table-body');
        for(let i=1; i<=5; i++) {
            const row = document.createElement('tr');
            row.className = 'border-b border-white/5 hover:bg-white/[0.02] transition-colors group';
            row.innerHTML = `
                <td class="p-4 flex items-center gap-3">
                    <div class="w-8 h-8 rounded-full bg-neutral-700 flex items-center justify-center text-xs text-white">U${i}</div>
                    <span class="text-neutral-300 font-medium group-hover:text-blue-400 transition-colors">User_${i}</span>
                </td>
                <td class="p-4">
                    <span class="px-2 py-1 rounded text-[10px] font-bold bg-amber-500/10 text-amber-500 border border-amber-500/20">PRO</span>
                </td>
                <td class="p-4">
                    <span class="flex items-center gap-1.5 text-xs text-green-400">
                        <span class="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></span> Active
                    </span>
                </td>
                <td class="p-4 text-white font-mono">¥99.00</td>
                <td class="p-4 text-neutral-500 text-xs">2023-10-2${i}</td>
            `;
            tableBody.appendChild(row);
        }

        // Render Health Stats
        const healthContainer = document.getElementById('health-stats');
        healthStats.forEach(item => {
            const el = document.createElement('div');
            el.innerHTML = `
                <div class="flex justify-between text-xs mb-1.5">
                    <span class="text-neutral-400">${item.label}</span>
                    <span class="text-white font-mono">${item.value}%</span>
                </div>
                <div class="h-1.5 bg-[#27272a] rounded-full overflow-hidden">
                    <div class="h-full rounded-full transition-all duration-1000 ease-out ${item.color}" style="width: ${item.value}%"></div>
                </div>
            `;
            healthContainer.appendChild(el);
        });
    </script>
</body>
</html>